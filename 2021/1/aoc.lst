     1                                 %line 1+1 aoc.asm
     2                                 
     3                                 
     4                                 [section .data]
     5 00000000 2E2F696E70757400        inputFile db "./input", 0
     6                                 
     7 00000008 256C750A00              numfmt db "%lu", 10, 0
     8                                 
     9                                  EXIT_SUCCESS equ 0
    10                                  SYS_exit equ 60
    11                                 
    12                                 
    13                                 [section .bss]
    14 00000000 <gap>                   stat resb 144
    15 00000090 <gap>                   fileHandle resq 1
    16 00000098 <gap>                   bufAddr1 resq 1
    17 000000A0 <gap>                   bufAddr2 resq 1
    18                                 
    19                                 [absolute 0]
    20                                 %line 18+0 aoc.asm
    21                                 STAT:
    22                                 %line 19+1 aoc.asm
    23                                  .st_dev resq 1
    24                                  .st_ino resq 1
    25                                  .st_nlink resq 1
    26                                  .st_mode resd 1
    27                                  .st_uid resd 1
    28                                  .st_gid resd 1
    29                                  .pad0 resb 4
    30                                  .st_rdev resq 1
    31                                  .st_size resq 1
    32                                  .st_blksize resq 1
    33                                  .st_blocks resq 1
    34                                  .st_atime resq 1
    35                                  .st_atime_nsec resq 1
    36                                  .st_mtime resq 1
    37                                  .st_mtime_nsec resq 1
    38                                  .st_ctime resq 1
    39                                  .st_ctime_nsec resq 1
    40                                 STAT_size EQU $ - STAT
    41                                 %line 36+0 aoc.asm
    42                                 [section .bss]
    43                                 %line 37+1 aoc.asm
    44                                 
    45                                 [extern malloc]
    46                                 [extern free]
    47                                 [extern printf]
    48                                 [extern memcpy]
    49                                 
    50                                 [extern solve1]
    51                                 [extern solve2]
    52                                 
    53                                 
    54                                 [section .text]
    55                                 [global _start]
    56                                 _start:
    57 00000000 55                      push rbp
    58 00000001 4889E5                  mov rbp, rsp
    59 00000004 53                      push rbx
    60 00000005 4157                    push r15
    61 00000007 4156                    push r14
    62 00000009 4155                    push r13
    63 0000000B 4154                    push r12
    64 0000000D 4883EC08                sub rsp, 8
    65                                 
    66                                 main:
    67                                 
    68 00000011 48C7C004000000          mov rax, 4
    69 00000018 48C7C7[00000000]        mov rdi, inputFile
    70 0000001F 48C7C6[00000000]        mov rsi, stat
    71 00000026 0F05                    syscall
    72                                 
    73                                 
    74 00000028 488B3C25[30000000]      mov rdi, qword [stat + STAT.st_size]
    75 00000030 E8(F6FFFFFF)            call malloc
    76 00000035 48890425[00000000]      mov [bufAddr1], rax
    77 0000003D 488B3C25[30000000]      mov rdi, qword [stat + STAT.st_size]
    78 00000045 E8(F6FFFFFF)            call malloc
    79 0000004A 48890425[00000000]      mov [bufAddr2], rax
    80                                 
    81                                 
    82 00000052 48C7C002000000          mov rax, 2
    83 00000059 48C7C7[00000000]        mov rdi, inputFile
    84 00000060 48C7C600000000          mov rsi, 0
    85 00000067 0F05                    syscall
    86 00000069 48890425[00000000]      mov [fileHandle], rax
    87                                 
    88                                 
    89 00000071 48C7C000000000          mov rax, 0
    90 00000078 488B3C25[00000000]      mov rdi, [fileHandle]
    91 00000080 488B3425[00000000]      mov rsi, [bufAddr1]
    92 00000088 488B1425[30000000]      mov rdx, qword [stat + STAT.st_size]
    93 00000090 0F05                    syscall
    94                                 
    95                                 
    96 00000092 48C7C003000000          mov rax, 3
    97 00000099 488B3C25[00000000]      mov rdi, [fileHandle]
    98 000000A1 0F05                    syscall
    99                                 
   100                                 
   101 000000A3 488B3C25[00000000]      mov rdi, [bufAddr2]
   102 000000AB 488B3425[00000000]      mov rsi, [bufAddr1]
   103 000000B3 488B1425[30000000]      mov rdx, qword [stat + STAT.st_size]
   104 000000BB E8(F6FFFFFF)            call memcpy
   105                                 
   106                                 
   107 000000C0 488B3C25[00000000]      mov rdi, [bufAddr1]
   108 000000C8 488B3425[30000000]      mov rsi, qword [stat + STAT.st_size]
   109 000000D0 E8(F6FFFFFF)            call solve1
   110                                 
   111                                 
   112 000000D5 48C7C7[00000000]        mov rdi, numfmt
   113 000000DC 4889C6                  mov rsi, rax
   114 000000DF 4831C0                  xor rax, rax
   115 000000E2 E8(F6FFFFFF)            call printf
   116                                 
   117                                 
   118 000000E7 488B3C25[00000000]      mov rdi, [bufAddr2]
   119 000000EF 488B3425[30000000]      mov rsi, qword [stat + STAT.st_size]
   120 000000F7 E8(F6FFFFFF)            call solve2
   121                                 
   122                                 
   123 000000FC 48C7C7[00000000]        mov rdi, numfmt
   124 00000103 4889C6                  mov rsi, rax
   125 00000106 4831C0                  xor rax, rax
   126 00000109 E8(F6FFFFFF)            call printf
   127                                 
   128                                 
   129 0000010E 488B3C25[00000000]      mov rdi, [bufAddr1]
   130 00000116 E8(F6FFFFFF)            call free
   131 0000011B 488B3C25[00000000]      mov rdi, [bufAddr2]
   132 00000123 E8(F6FFFFFF)            call free
   133                                 
   134                                 fin:
   135 00000128 4883C408                add rsp, 8
   136 0000012C 415C                    pop r12
   137 0000012E 415D                    pop r13
   138 00000130 415E                    pop r14
   139 00000132 415F                    pop r15
   140 00000134 5B                      pop rbx
   141 00000135 4889EC                  mov rsp, rbp
   142 00000138 5D                      pop rbp
   143 00000139 48C7C03C000000          mov rax, SYS_exit
   144 00000140 48C7C700000000          mov rdi, EXIT_SUCCESS
   145 00000147 0F05                    syscall
